---
/**
 * Timeline - Main timeline container component
 * Supports two modes:
 * 1. Array mode: Pass items[] prop to render from data
 * 2. Slot mode: Use <slot> for manual composition with TimelineItem
 */
import type { TimelineProps, TimelineEntry } from './types';
import TimelineItem from './TimelineItem.astro';

// Tell TypeScript what props this component accepts
interface Props extends TimelineProps {}

// Extract props with defaults
// class is renamed to className (class is reserved keyword in JS)
const { items = [], class: className, lineColor, dotColor, layout = 'default' } = Astro.props;

// Check if items array has data (determines which mode to use)
const hasItems = items.length > 0;
---

<!-- Timeline container with optional custom colors via CSS variables -->
<div
  class:list={['aj-timeline', `aj-timeline--${layout}`, className]}
  style={[
    lineColor && `--aj-line-color: ${lineColor}`,
    dotColor && `--aj-dot-color: ${dotColor}`
  ].filter(Boolean).join('; ')}
>
  {hasItems ? (
    /* Array mode: loop through items and render TimelineItemComponent */
    items.map((item: TimelineEntry, index: number) => (
      <TimelineItem
        date={item.date}
        title={item.title}
        description={item.description}
        link={item.link}
        isLast={index === items.length - 1}
        layout={layout}
      />
    ))
  ) : (
    /* Slot mode: render children passed between <Timeline>...</Timeline> */
    <slot />
  )}
</div>
